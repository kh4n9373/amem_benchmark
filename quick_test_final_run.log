âš¡ Running quick test (20 conversations) with A-mem...

Created test dataset with 20 conversations
Loading dataset from /home/vinhpq/mem_baseline/amem/data/locomo/processed_data/locomo_small_test.json...
Loaded 1 conversations
Processing shard 1/1
Indexing (shard 0/1):   0%|          | 0/1 [00:00<?, ?it/s]No sentence-transformers model found with name facebook/contriever. Creating a new one with mean pooling.

Processing conversation 1/1: conv-26
  Turns to add: 224

Adding turns [conv-26]:   0%|          | 0/224 [00:00<?, ?it/s][A
Adding turns [conv-26]:   0%|          | 1/224 [00:00<01:26,  2.59it/s][AError in memory evolution: Expecting ',' delimiter: line 913 column 1 (char 4301)

Adding turns [conv-26]:   1%|          | 2/224 [00:15<32:27,  8.77s/it][A
Adding turns [conv-26]:   1%|â–         | 3/224 [00:16<20:45,  5.64s/it][A
Adding turns [conv-26]:   2%|â–         | 4/224 [00:18<14:58,  4.09s/it][A
Adding turns [conv-26]:   2%|â–         | 5/224 [00:22<14:54,  4.08s/it][A
Adding turns [conv-26]:   3%|â–Ž         | 6/224 [00:24<12:18,  3.39s/it][A
Adding turns [conv-26]:   3%|â–Ž         | 7/224 [00:26<10:38,  2.94s/it][A
Adding turns [conv-26]:   4%|â–Ž         | 8/224 [00:31<12:12,  3.39s/it][A
Adding turns [conv-26]:   4%|â–         | 9/224 [00:35<12:59,  3.62s/it][A
Adding turns [conv-26]:   4%|â–         | 10/224 [00:39<13:28,  3.78s/it][A
Adding turns [conv-26]:   5%|â–         | 11/224 [00:42<12:53,  3.63s/it][A
Adding turns [conv-26]:   5%|â–Œ         | 12/224 [00:45<11:45,  3.33s/it][A
Adding turns [conv-26]:   6%|â–Œ         | 13/224 [00:47<10:42,  3.04s/it][A
Adding turns [conv-26]:   6%|â–‹         | 14/224 [00:52<12:28,  3.56s/it][A
Adding turns [conv-26]:   7%|â–‹         | 15/224 [00:56<12:56,  3.72s/it][A
Adding turns [conv-26]:   7%|â–‹         | 16/224 [01:00<12:52,  3.71s/it][A
Adding turns [conv-26]:   8%|â–Š         | 17/224 [01:05<14:04,  4.08s/it][A
Adding turns [conv-26]:   8%|â–Š         | 18/224 [01:08<13:17,  3.87s/it][A
Adding turns [conv-26]:   8%|â–Š         | 19/224 [01:10<11:31,  3.37s/it][A
Adding turns [conv-26]:   9%|â–‰         | 20/224 [01:16<14:03,  4.13s/it][A
Adding turns [conv-26]:   9%|â–‰         | 21/224 [01:25<18:54,  5.59s/it][A
Adding turns [conv-26]:  10%|â–‰         | 22/224 [01:30<18:26,  5.48s/it][A
Adding turns [conv-26]:  10%|â–ˆ         | 23/224 [01:37<19:54,  5.94s/it][A
Adding turns [conv-26]:  11%|â–ˆ         | 24/224 [01:44<20:55,  6.28s/it][A
Adding turns [conv-26]:  11%|â–ˆ         | 25/224 [01:48<18:17,  5.51s/it][A
Adding turns [conv-26]:  12%|â–ˆâ–        | 26/224 [01:53<17:55,  5.43s/it][A
Adding turns [conv-26]:  12%|â–ˆâ–        | 27/224 [01:56<14:49,  4.52s/it][AError in memory evolution: Expecting ',' delimiter: line 3460 column 32 (char 13683)

Adding turns [conv-26]:  12%|â–ˆâ–Ž        | 28/224 [02:11<24:42,  7.57s/it][A
Adding turns [conv-26]:  13%|â–ˆâ–Ž        | 29/224 [02:14<20:08,  6.20s/it][A
Adding turns [conv-26]:  13%|â–ˆâ–Ž        | 30/224 [02:17<17:29,  5.41s/it][A
Adding turns [conv-26]:  14%|â–ˆâ–        | 31/224 [02:21<15:40,  4.87s/it][A
Adding turns [conv-26]:  14%|â–ˆâ–        | 32/224 [02:23<13:08,  4.10s/it][A
Adding turns [conv-26]:  15%|â–ˆâ–        | 33/224 [02:26<11:57,  3.76s/it][A
Adding turns [conv-26]:  15%|â–ˆâ–Œ        | 34/224 [02:30<12:07,  3.83s/it][A
Adding turns [conv-26]:  16%|â–ˆâ–Œ        | 35/224 [02:36<13:41,  4.35s/it][A
Adding turns [conv-26]:  16%|â–ˆâ–Œ        | 36/224 [02:39<12:22,  3.95s/it][A
Adding turns [conv-26]:  17%|â–ˆâ–‹        | 37/224 [02:41<10:56,  3.51s/it][A
Adding turns [conv-26]:  17%|â–ˆâ–‹        | 38/224 [02:49<15:19,  4.94s/it][A
Adding turns [conv-26]:  17%|â–ˆâ–‹        | 39/224 [02:56<16:32,  5.36s/it][A
Adding turns [conv-26]:  18%|â–ˆâ–Š        | 40/224 [03:00<15:29,  5.05s/it][A
Adding turns [conv-26]:  18%|â–ˆâ–Š        | 41/224 [03:03<13:52,  4.55s/it][A
Adding turns [conv-26]:  19%|â–ˆâ–‰        | 42/224 [03:14<19:27,  6.41s/it][A
Adding turns [conv-26]:  19%|â–ˆâ–‰        | 43/224 [03:20<19:15,  6.38s/it][A
Adding turns [conv-26]:  20%|â–ˆâ–‰        | 44/224 [03:27<19:04,  6.36s/it][A
Adding turns [conv-26]:  20%|â–ˆâ–ˆ        | 45/224 [03:32<18:19,  6.14s/it][A
Adding turns [conv-26]:  21%|â–ˆâ–ˆ        | 46/224 [03:35<15:00,  5.06s/it][A
Adding turns [conv-26]:  21%|â–ˆâ–ˆ        | 47/224 [03:42<17:04,  5.79s/it][A
Adding turns [conv-26]:  21%|â–ˆâ–ˆâ–       | 48/224 [03:51<19:17,  6.57s/it][A
Adding turns [conv-26]:  22%|â–ˆâ–ˆâ–       | 49/224 [03:53<15:31,  5.32s/it][A
Adding turns [conv-26]:  22%|â–ˆâ–ˆâ–       | 50/224 [03:56<13:11,  4.55s/it][A
Adding turns [conv-26]:  23%|â–ˆâ–ˆâ–Ž       | 51/224 [04:00<13:01,  4.52s/it][A
Adding turns [conv-26]:  23%|â–ˆâ–ˆâ–Ž       | 52/224 [04:07<14:47,  5.16s/it][A
Adding turns [conv-26]:  24%|â–ˆâ–ˆâ–Ž       | 53/224 [04:15<16:51,  5.92s/it][AError in memory evolution: Expecting ',' delimiter: line 781 column 1 (char 5578)

Adding turns [conv-26]:  24%|â–ˆâ–ˆâ–       | 54/224 [04:29<24:13,  8.55s/it][A
Adding turns [conv-26]:  25%|â–ˆâ–ˆâ–       | 55/224 [04:34<20:58,  7.44s/it][A
Adding turns [conv-26]:  25%|â–ˆâ–ˆâ–Œ       | 56/224 [04:37<17:01,  6.08s/it][A
Adding turns [conv-26]:  25%|â–ˆâ–ˆâ–Œ       | 57/224 [04:40<14:05,  5.06s/it][A
Adding turns [conv-26]:  26%|â–ˆâ–ˆâ–Œ       | 58/224 [04:43<12:35,  4.55s/it][A
Adding turns [conv-26]:  26%|â–ˆâ–ˆâ–‹       | 59/224 [04:48<12:32,  4.56s/it][A
Adding turns [conv-26]:  27%|â–ˆâ–ˆâ–‹       | 60/224 [04:55<14:46,  5.40s/it][A
Adding turns [conv-26]:  27%|â–ˆâ–ˆâ–‹       | 61/224 [04:59<13:24,  4.93s/it][A
Adding turns [conv-26]:  28%|â–ˆâ–ˆâ–Š       | 62/224 [05:04<13:24,  4.96s/it][A
Adding turns [conv-26]:  28%|â–ˆâ–ˆâ–Š       | 63/224 [05:11<15:18,  5.70s/it][A
Adding turns [conv-26]:  29%|â–ˆâ–ˆâ–Š       | 64/224 [05:16<14:10,  5.31s/it][A
Adding turns [conv-26]:  29%|â–ˆâ–ˆâ–‰       | 65/224 [05:20<13:15,  5.00s/it][A
Adding turns [conv-26]:  29%|â–ˆâ–ˆâ–‰       | 66/224 [05:26<14:11,  5.39s/it][A
Adding turns [conv-26]:  30%|â–ˆâ–ˆâ–‰       | 67/224 [05:28<11:15,  4.30s/it][A
Adding turns [conv-26]:  30%|â–ˆâ–ˆâ–ˆ       | 68/224 [05:35<13:05,  5.04s/it][A
Adding turns [conv-26]:  31%|â–ˆâ–ˆâ–ˆ       | 69/224 [05:39<12:30,  4.84s/it][A
Adding turns [conv-26]:  31%|â–ˆâ–ˆâ–ˆâ–      | 70/224 [05:42<10:33,  4.12s/it][A
Adding turns [conv-26]:  32%|â–ˆâ–ˆâ–ˆâ–      | 71/224 [05:44<09:14,  3.63s/it][A
Adding turns [conv-26]:  32%|â–ˆâ–ˆâ–ˆâ–      | 72/224 [05:53<12:41,  5.01s/it][A
Adding turns [conv-26]:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 73/224 [05:55<10:56,  4.35s/it][A
Adding turns [conv-26]:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 74/224 [06:00<11:10,  4.47s/it][A
Adding turns [conv-26]:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 75/224 [06:05<11:23,  4.59s/it][A
Adding turns [conv-26]:  34%|â–ˆâ–ˆâ–ˆâ–      | 76/224 [06:10<11:50,  4.80s/it][A
Adding turns [conv-26]:  34%|â–ˆâ–ˆâ–ˆâ–      | 77/224 [06:14<11:08,  4.55s/it][A
Adding turns [conv-26]:  35%|â–ˆâ–ˆâ–ˆâ–      | 78/224 [06:17<09:58,  4.10s/it][A
Adding turns [conv-26]:  35%|â–ˆâ–ˆâ–ˆâ–Œ      | 79/224 [06:20<08:43,  3.61s/it][A
Adding turns [conv-26]:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 80/224 [06:24<09:20,  3.89s/it][A
Adding turns [conv-26]:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 81/224 [06:29<09:38,  4.05s/it][A
Adding turns [conv-26]:  37%|â–ˆâ–ˆâ–ˆâ–‹      | 82/224 [06:33<09:26,  3.99s/it][A
Adding turns [conv-26]:  37%|â–ˆâ–ˆâ–ˆâ–‹      | 83/224 [06:39<11:07,  4.73s/it][A
Adding turns [conv-26]:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 84/224 [06:43<10:41,  4.58s/it][A
Adding turns [conv-26]:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 85/224 [06:47<10:15,  4.43s/it][A
Adding turns [conv-26]:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 86/224 [06:52<10:43,  4.66s/it][A
Adding turns [conv-26]:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 87/224 [06:58<11:07,  4.87s/it][A
Adding turns [conv-26]:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 88/224 [07:01<10:00,  4.41s/it][A
Adding turns [conv-26]:  40%|â–ˆâ–ˆâ–ˆâ–‰      | 89/224 [07:07<10:45,  4.78s/it][A
Adding turns [conv-26]:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 90/224 [07:16<13:49,  6.19s/it][A
Adding turns [conv-26]:  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 91/224 [07:22<13:21,  6.03s/it][A
Adding turns [conv-26]:  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 92/224 [07:27<12:21,  5.62s/it][A
Adding turns [conv-26]:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 93/224 [07:29<10:08,  4.65s/it][A
Adding turns [conv-26]:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 94/224 [07:36<11:21,  5.24s/it][A
Adding turns [conv-26]:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 95/224 [07:43<12:27,  5.80s/it][A
Adding turns [conv-26]:  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 96/224 [07:47<11:25,  5.36s/it][A
Adding turns [conv-26]:  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 97/224 [07:51<10:45,  5.08s/it][A
Adding turns [conv-26]:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 98/224 [07:54<09:05,  4.33s/it][A
Adding turns [conv-26]:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 99/224 [07:59<09:42,  4.66s/it][A
Adding turns [conv-26]:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 100/224 [08:02<08:30,  4.12s/it][A
Adding turns [conv-26]:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 101/224 [08:06<07:59,  3.90s/it][A
Adding turns [conv-26]:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 102/224 [08:11<08:44,  4.30s/it][A
Adding turns [conv-26]:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 103/224 [08:15<08:39,  4.29s/it][A
Adding turns [conv-26]:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 104/224 [08:30<15:01,  7.51s/it][A
Adding turns [conv-26]:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 105/224 [08:37<14:33,  7.34s/it][A
Adding turns [conv-26]:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 106/224 [08:43<13:32,  6.88s/it][A
Adding turns [conv-26]:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 107/224 [08:46<11:03,  5.67s/it][A
Adding turns [conv-26]:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 108/224 [08:52<11:05,  5.73s/it][A
Adding turns [conv-26]:  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 109/224 [08:56<10:08,  5.29s/it][A
Adding turns [conv-26]:  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 110/224 [08:59<08:59,  4.73s/it][A
Adding turns [conv-26]:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 111/224 [09:07<10:22,  5.51s/it][A
Adding turns [conv-26]:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 112/224 [09:11<09:51,  5.28s/it][A
Adding turns [conv-26]:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 113/224 [09:15<08:42,  4.71s/it][A
Adding turns [conv-26]:  51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 114/224 [09:17<07:23,  4.03s/it][A
Adding turns [conv-26]:  51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 115/224 [09:22<07:40,  4.23s/it][A
Adding turns [conv-26]:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 116/224 [09:27<08:17,  4.60s/it][A
Adding turns [conv-26]:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 117/224 [09:35<09:46,  5.48s/it][A
Adding turns [conv-26]:  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 118/224 [09:38<08:27,  4.79s/it][A
Adding turns [conv-26]:  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 119/224 [09:45<09:41,  5.54s/it][A
Adding turns [conv-26]:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 120/224 [09:48<08:01,  4.63s/it][A
Adding turns [conv-26]:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 121/224 [09:53<08:11,  4.78s/it][A
Adding turns [conv-26]:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 122/224 [09:59<08:48,  5.18s/it][A
Adding turns [conv-26]:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 123/224 [10:02<07:38,  4.54s/it][A
Adding turns [conv-26]:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 124/224 [10:05<06:53,  4.14s/it][A
Adding turns [conv-26]:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 125/224 [10:13<08:19,  5.05s/it][A
Adding turns [conv-26]:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 126/224 [10:19<08:49,  5.40s/it][A
Adding turns [conv-26]:  57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 127/224 [10:22<07:44,  4.79s/it][A
Adding turns [conv-26]:  57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 128/224 [10:27<07:51,  4.91s/it][A
Adding turns [conv-26]:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 129/224 [10:35<09:04,  5.74s/it][A
Adding turns [conv-26]:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 130/224 [10:40<08:33,  5.46s/it][A
Adding turns [conv-26]:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 131/224 [10:42<06:50,  4.42s/it][A
Adding turns [conv-26]:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 132/224 [10:48<07:33,  4.93s/it][A
Adding turns [conv-26]:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 133/224 [10:52<06:49,  4.50s/it][A
Adding turns [conv-26]:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 134/224 [10:54<06:00,  4.00s/it][A
Adding turns [conv-26]:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 135/224 [10:58<05:53,  3.97s/it][A
Adding turns [conv-26]:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 136/224 [11:03<06:19,  4.31s/it][A
Adding turns [conv-26]:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 137/224 [11:06<05:38,  3.89s/it][A
Adding turns [conv-26]:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 138/224 [11:12<06:28,  4.52s/it][A
Adding turns [conv-26]:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 139/224 [11:15<05:40,  4.00s/it][A
Adding turns [conv-26]:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 140/224 [11:22<06:55,  4.95s/it][A
Adding turns [conv-26]:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 141/224 [11:25<05:58,  4.32s/it][A
Adding turns [conv-26]:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 142/224 [11:28<05:29,  4.01s/it][A
Adding turns [conv-26]:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 143/224 [11:34<05:55,  4.39s/it][A
Adding turns [conv-26]:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 144/224 [11:36<05:10,  3.88s/it][A
Adding turns [conv-26]:  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 145/224 [11:39<04:45,  3.62s/it][A
Adding turns [conv-26]:  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 146/224 [11:43<04:50,  3.72s/it][A
Adding turns [conv-26]:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 147/224 [11:48<05:09,  4.02s/it][A
Adding turns [conv-26]:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 148/224 [11:53<05:31,  4.36s/it][A
Adding turns [conv-26]:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 149/224 [11:57<05:04,  4.06s/it][A
Adding turns [conv-26]:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 150/224 [12:04<06:05,  4.94s/it][A
Adding turns [conv-26]:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 151/224 [12:09<06:05,  5.01s/it][A
Adding turns [conv-26]:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 152/224 [12:12<05:33,  4.63s/it][A
Adding turns [conv-26]:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 153/224 [12:18<05:50,  4.94s/it][AError in memory evolution: Expecting ',' delimiter: line 3737 column 1 (char 13898)

Adding turns [conv-26]:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 154/224 [12:33<09:11,  7.88s/it][A
Adding turns [conv-26]:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 155/224 [12:50<12:08, 10.56s/it][A
Adding turns [conv-26]:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 156/224 [12:54<09:55,  8.76s/it][A
Adding turns [conv-26]:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 157/224 [12:59<08:20,  7.47s/it][A
Adding turns [conv-26]:  71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 158/224 [13:02<06:42,  6.10s/it][A
Adding turns [conv-26]:  71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 159/224 [13:07<06:22,  5.89s/it][A
Adding turns [conv-26]:  71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 160/224 [13:10<05:28,  5.13s/it][A
Adding turns [conv-26]:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 161/224 [13:14<04:58,  4.75s/it][A
Adding turns [conv-26]:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 162/224 [13:20<05:18,  5.14s/it][A
Adding turns [conv-26]:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 163/224 [13:25<05:12,  5.12s/it][A
Adding turns [conv-26]:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 164/224 [13:31<05:18,  5.30s/it][A
Adding turns [conv-26]:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 165/224 [13:37<05:30,  5.60s/it][A
Adding turns [conv-26]:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 166/224 [13:41<04:44,  4.91s/it][A
Adding turns [conv-26]:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 167/224 [13:47<05:02,  5.31s/it][A
Adding turns [conv-26]:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 168/224 [13:50<04:16,  4.59s/it][A
Adding turns [conv-26]:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 169/224 [13:54<04:01,  4.39s/it][A
Adding turns [conv-26]:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 170/224 [13:57<03:42,  4.12s/it][A
Adding turns [conv-26]:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 171/224 [14:01<03:28,  3.94s/it][A
Adding turns [conv-26]:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 172/224 [14:05<03:28,  4.01s/it][A
Adding turns [conv-26]:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 173/224 [14:09<03:25,  4.03s/it][A
Adding turns [conv-26]:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 174/224 [14:12<03:13,  3.86s/it][A
Adding turns [conv-26]:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 175/224 [14:18<03:28,  4.26s/it][A
Adding turns [conv-26]:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 176/224 [14:22<03:23,  4.24s/it][A
Adding turns [conv-26]:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 177/224 [14:25<03:00,  3.85s/it][A
Adding turns [conv-26]:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 178/224 [14:29<03:03,  3.98s/it][A
Adding turns [conv-26]:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 179/224 [14:34<03:13,  4.30s/it][A
Adding turns [conv-26]:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 180/224 [14:41<03:41,  5.03s/it][A
Adding turns [conv-26]:  81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 181/224 [14:46<03:39,  5.10s/it][A
Adding turns [conv-26]:  81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 182/224 [14:51<03:36,  5.15s/it][A
Adding turns [conv-26]:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 183/224 [14:55<03:10,  4.65s/it][A
Adding turns [conv-26]:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 184/224 [14:59<03:05,  4.63s/it][A
Adding turns [conv-26]:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 185/224 [15:08<03:46,  5.81s/it][A
Adding turns [conv-26]:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 186/224 [15:11<03:08,  4.97s/it][A
Adding turns [conv-26]:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 187/224 [15:15<02:49,  4.59s/it][A
Adding turns [conv-26]:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 188/224 [15:20<02:54,  4.84s/it][A
Adding turns [conv-26]:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 189/224 [15:24<02:34,  4.40s/it][A
Adding turns [conv-26]:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 190/224 [15:29<02:38,  4.67s/it][A
Adding turns [conv-26]:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 191/224 [15:31<02:12,  4.00s/it][A
Adding turns [conv-26]:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 192/224 [15:34<02:00,  3.77s/it][A
Adding turns [conv-26]:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 193/224 [15:41<02:17,  4.45s/it][A
Adding turns [conv-26]:  87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 194/224 [15:43<01:58,  3.96s/it][A
Adding turns [conv-26]:  87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 195/224 [15:48<01:57,  4.04s/it][A
Adding turns [conv-26]:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 196/224 [15:55<02:18,  4.96s/it][A
Adding turns [conv-26]:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 197/224 [16:00<02:15,  5.01s/it][A
Adding turns [conv-26]:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 198/224 [16:05<02:15,  5.19s/it][A
Adding turns [conv-26]:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 199/224 [16:10<02:02,  4.90s/it][A
Adding turns [conv-26]:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 200/224 [16:15<01:59,  4.97s/it][A
Adding turns [conv-26]:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 201/224 [16:20<01:59,  5.18s/it][A
Adding turns [conv-26]:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 202/224 [16:24<01:42,  4.67s/it][A
Adding turns [conv-26]:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 203/224 [16:27<01:29,  4.26s/it][AError in memory evolution: Expecting ',' delimiter: line 718 column 4 (char 4673)

Adding turns [conv-26]:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 204/224 [16:42<02:27,  7.39s/it][A
Adding turns [conv-26]:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 205/224 [16:44<01:52,  5.93s/it][A
Adding turns [conv-26]:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 206/224 [17:08<03:21, 11.21s/it][A
Adding turns [conv-26]:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 207/224 [17:11<02:31,  8.91s/it][A
Adding turns [conv-26]:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 208/224 [17:14<01:53,  7.10s/it][A
Adding turns [conv-26]:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 209/224 [17:16<01:23,  5.58s/it][A
Adding turns [conv-26]:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 210/224 [17:21<01:12,  5.20s/it][A
Adding turns [conv-26]:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 211/224 [17:24<00:59,  4.58s/it][A
Adding turns [conv-26]:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 212/224 [17:29<00:56,  4.73s/it][A
Adding turns [conv-26]:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 213/224 [17:33<00:50,  4.57s/it][A
Adding turns [conv-26]:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 214/224 [17:38<00:46,  4.67s/it][A
Adding turns [conv-26]:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 215/224 [17:42<00:39,  4.34s/it][A
Adding turns [conv-26]:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 216/224 [17:45<00:32,  4.04s/it][A
Adding turns [conv-26]:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 217/224 [17:50<00:30,  4.42s/it][A
Adding turns [conv-26]:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 218/224 [17:56<00:29,  4.90s/it][A
Adding turns [conv-26]:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 219/224 [18:01<00:24,  4.84s/it][A
Adding turns [conv-26]:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 220/224 [18:07<00:21,  5.29s/it][A
Adding turns [conv-26]:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 221/224 [18:12<00:15,  5.19s/it][A
Adding turns [conv-26]:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 222/224 [18:16<00:09,  4.78s/it][A
Adding turns [conv-26]: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 223/224 [18:20<00:04,  4.45s/it][A
Adding turns [conv-26]: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 224/224 [18:23<00:00,  4.09s/it][A
                                                                         [AIndexing (shard 0/1): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [18:26<00:00, 1106.34s/it]Indexing (shard 0/1): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [18:26<00:00, 1106.34s/it]

  ðŸ’¾ Saving ChromaDB to disk...
  âœ… Saved 224 memories to persistent ChromaDB
  Successfully indexed 224/224 turns
  ChromaDB persisted to: /home/vinhpq/mem_baseline/amem/test_memory_20251211_095326/conv-26
  Metadata saved to: /home/vinhpq/mem_baseline/amem/test_memory_20251211_095326/conv-26/memory_metadata.json

âœ… Indexing completed!
   Processed 1 conversations
   Metadata saved to: /home/vinhpq/mem_baseline/amem/test_memory_20251211_095326/index_metadata_0.json
Loading dataset from /home/vinhpq/mem_baseline/amem/data/locomo/processed_data/locomo_small_test.json...
Loaded 1 conversations
Retrieving top-100 memories per question
Retrieving:   0%|          | 0/1 [00:00<?, ?it/s]No sentence-transformers model found with name facebook/contriever. Creating a new one with mean pooling.
Retrieving: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:12<00:00, 12.56s/it]Retrieving: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:12<00:00, 12.57s/it]

âœ… Retrieval completed!
   Total questions: 199
   Processed questions: 199
   Results saved to: /home/vinhpq/mem_baseline/amem/test_results_20251211_095326/retrieval_results_20251211_095326.json
Eval records:   0%|          | 0/199 [00:00<?, ?it/s]Eval records:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 87/199 [00:00<00:00, 867.28it/s]Eval records:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 198/199 [00:00<00:00, 1008.54it/s]Eval records: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 199/199 [00:00<00:00, 987.01it/s] 

=== File: /home/vinhpq/mem_baseline/amem/test_results_20251211_095326/retrieval_results_20251211_095326.json ===
=== Retrieval evaluation ===
--- @ 3 (n=197) ---
Macro  | P: 0.0795  R: 0.2128  F1: 0.1128  nDCG: 0.2015
Micro  | P: 0.0795  R: 0.1880  F1: 0.1118  nDCG: 0.8649
--- @ 5 (n=197) ---
Macro  | P: 0.0640  R: 0.2864  F1: 0.1026  nDCG: 0.2347
Micro  | P: 0.0640  R: 0.2520  F1: 0.1020  nDCG: 0.7484
--- @ 10 (n=197) ---
Macro  | P: 0.0442  R: 0.3926  F1: 0.0783  nDCG: 0.2689
Micro  | P: 0.0442  R: 0.3480  F1: 0.0784  nDCG: 0.6340

=== Category-based evaluation ===

--- Category: 1 ---
  @ 3 (n=32)
    Macro  | P: 0.0625  R: 0.0599  F1: 0.0601  nDCG: 0.1406
    Micro  | P: 0.0625  R: 0.0811  F1: 0.0706  nDCG: 0.9112
  @ 5 (n=32)
    Macro  | P: 0.0500  R: 0.0911  F1: 0.0632  nDCG: 0.1662
    Micro  | P: 0.0500  R: 0.1081  F1: 0.0684  nDCG: 0.7795
  @ 10 (n=32)
    Macro  | P: 0.0312  R: 0.1094  F1: 0.0479  nDCG: 0.1617
    Micro  | P: 0.0312  R: 0.1351  F1: 0.0508  nDCG: 0.7490

--- Category: 2 ---
  @ 3 (n=37)
    Macro  | P: 0.0811  R: 0.2432  F1: 0.1216  nDCG: 0.2198
    Micro  | P: 0.0811  R: 0.2432  F1: 0.1216  nDCG: 0.9034
  @ 5 (n=37)
    Macro  | P: 0.0703  R: 0.3514  F1: 0.1171  nDCG: 0.2616
    Micro  | P: 0.0703  R: 0.3514  F1: 0.1171  nDCG: 0.7445
  @ 10 (n=37)
    Macro  | P: 0.0486  R: 0.4865  F1: 0.0885  nDCG: 0.3025
    Micro  | P: 0.0486  R: 0.4865  F1: 0.0885  nDCG: 0.6218

--- Category: 3 ---
  @ 3 (n=11)
    Macro  | P: 0.0303  R: 0.0455  F1: 0.0364  nDCG: 0.0909
    Micro  | P: 0.0303  R: 0.0500  F1: 0.0377  nDCG: 1.0000
  @ 5 (n=11)
    Macro  | P: 0.0182  R: 0.0455  F1: 0.0260  nDCG: 0.0909
    Micro  | P: 0.0182  R: 0.0500  F1: 0.0267  nDCG: 1.0000
  @ 10 (n=11)
    Macro  | P: 0.0455  R: 0.2576  F1: 0.0760  nDCG: 0.2056
    Micro  | P: 0.0455  R: 0.2500  F1: 0.0769  nDCG: 0.4524

--- Category: 4 ---
  @ 3 (n=70)
    Macro  | P: 0.0810  R: 0.2429  F1: 0.1214  nDCG: 0.1954
    Micro  | P: 0.0810  R: 0.2394  F1: 0.1210  nDCG: 0.8046
  @ 5 (n=70)
    Macro  | P: 0.0686  R: 0.3357  F1: 0.1136  nDCG: 0.2378
    Micro  | P: 0.0686  R: 0.3380  F1: 0.1140  nDCG: 0.6937
  @ 10 (n=70)
    Macro  | P: 0.0457  R: 0.4500  F1: 0.0829  nDCG: 0.2744
    Micro  | P: 0.0457  R: 0.4507  F1: 0.0830  nDCG: 0.6002

--- Category: 5 ---
  @ 3 (n=47)
    Macro  | P: 0.0993  R: 0.2872  F1: 0.1468  nDCG: 0.2637
    Micro  | P: 0.0993  R: 0.2917  F1: 0.1481  nDCG: 0.8852
  @ 5 (n=47)
    Macro  | P: 0.0723  R: 0.3511  F1: 0.1196  nDCG: 0.2893
    Micro  | P: 0.0723  R: 0.3542  F1: 0.1201  nDCG: 0.7998
  @ 10 (n=47)
    Macro  | P: 0.0468  R: 0.4574  F1: 0.0848  nDCG: 0.3221
    Micro  | P: 0.0468  R: 0.4583  F1: 0.0849  nDCG: 0.6880

[Info] Skipped 2 record(s) without evidences.
ðŸ‘Œ Saved eval results -> /home/vinhpq/mem_baseline/amem/test_results_20251211_095326/retrieval_eval_20251211_095326.json
Loading retrieval results from /home/vinhpq/mem_baseline/amem/test_results_20251211_095326/retrieval_results_20251211_095326.json...
Loading ground truth from /home/vinhpq/mem_baseline/amem/data/locomo/processed_data/locomo_small_test.json...
Loaded 199 retrieval records
Loaded 597 ground truth answers
Initializing LLM client (model: Qwen/Qwen3-8B)...
Processing first 100 questions only (--limit)

Generating answers with LLM (context-k=5)...
Processing:   0%|          | 0/100 [00:00<?, ?it/s]Processing:   1%|          | 1/100 [00:00<00:36,  2.70it/s]Processing:   3%|â–Ž         | 3/100 [00:00<00:18,  5.27it/s]Processing:   4%|â–         | 4/100 [00:00<00:17,  5.62it/s]Processing:   5%|â–Œ         | 5/100 [00:00<00:17,  5.41it/s]Processing:   6%|â–Œ         | 6/100 [00:01<00:17,  5.28it/s]Processing:   7%|â–‹         | 7/100 [00:01<00:16,  5.58it/s]Processing:   9%|â–‰         | 9/100 [00:01<00:11,  8.23it/s]Processing:  10%|â–ˆ         | 10/100 [00:01<00:13,  6.61it/s]Processing:  11%|â–ˆ         | 11/100 [00:01<00:16,  5.35it/s]Processing:  12%|â–ˆâ–        | 12/100 [00:02<00:17,  4.95it/s]Processing:  13%|â–ˆâ–Ž        | 13/100 [00:02<00:19,  4.50it/s]Processing:  14%|â–ˆâ–        | 14/100 [00:02<00:18,  4.63it/s]Processing:  16%|â–ˆâ–Œ        | 16/100 [00:02<00:14,  5.63it/s]Processing:  17%|â–ˆâ–‹        | 17/100 [00:03<00:14,  5.59it/s]Processing:  19%|â–ˆâ–‰        | 19/100 [00:03<00:13,  6.17it/s]Processing:  20%|â–ˆâ–ˆ        | 20/100 [00:03<00:13,  6.08it/s]Processing:  21%|â–ˆâ–ˆ        | 21/100 [00:03<00:13,  5.77it/s]Processing:  22%|â–ˆâ–ˆâ–       | 22/100 [00:03<00:13,  5.67it/s]Processing:  24%|â–ˆâ–ˆâ–       | 24/100 [00:04<00:09,  8.06it/s]Processing:  25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:04<00:10,  6.94it/s]Processing:  26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:04<00:18,  4.00it/s]Processing:  27%|â–ˆâ–ˆâ–‹       | 27/100 [00:05<00:18,  3.99it/s]Processing:  29%|â–ˆâ–ˆâ–‰       | 29/100 [00:05<00:13,  5.16it/s]Processing:  30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:05<00:13,  5.23it/s]Processing:  32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:05<00:11,  6.16it/s]Processing:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:06<00:12,  5.47it/s]Processing:  34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:06<00:12,  5.46it/s]Processing:  35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:06<00:13,  4.71it/s]Processing:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:06<00:13,  4.87it/s]Processing:  37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:06<00:12,  5.03it/s]Processing:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:06<00:11,  5.56it/s]Processing:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:07<00:10,  5.75it/s]Processing:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:07<00:13,  4.31it/s]Processing:  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:07<00:12,  4.59it/s]Processing:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:07<00:11,  4.98it/s]Processing:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:08<00:08,  6.64it/s]Processing:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:08<00:09,  5.80it/s]Processing:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:08<00:09,  5.60it/s]Processing:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:08<00:08,  6.22it/s]Processing:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:09<00:08,  6.12it/s]Processing:  51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:09<00:07,  6.44it/s]Processing:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:09<00:09,  5.32it/s]Processing:  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:09<00:08,  5.32it/s]Processing:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:09<00:08,  5.46it/s]Processing:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:10<00:08,  5.45it/s]Processing:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:10<00:07,  5.98it/s]Processing:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:10<00:06,  6.06it/s]Processing:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:10<00:06,  5.92it/s]Processing:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:10<00:05,  7.30it/s]Processing:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:11<00:04,  7.98it/s]Processing:  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:11<00:03,  9.44it/s]Processing:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:11<00:06,  5.09it/s]Processing:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:12<00:06,  5.16it/s]Processing:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:12<00:06,  5.06it/s]Processing:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:12<00:05,  5.25it/s]Processing:  71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:12<00:05,  5.17it/s]Processing:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:13<00:06,  4.62it/s]Processing:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:13<00:08,  3.28it/s]Processing:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:13<00:06,  3.98it/s]Processing:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:13<00:06,  4.00it/s]Processing:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:14<00:05,  4.34it/s]Processing:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:14<00:04,  4.63it/s]Processing:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:14<00:02,  7.03it/s]Processing:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:14<00:02,  6.71it/s]Processing:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:14<00:01,  9.08it/s]Processing:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:15<00:02,  7.04it/s]Processing:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:15<00:02,  5.59it/s]Processing:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:15<00:02,  4.67it/s]Processing:  87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:15<00:02,  5.11it/s]Processing:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:16<00:02,  4.12it/s]Processing:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:16<00:02,  4.17it/s]Processing:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:16<00:02,  4.24it/s]Processing:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:16<00:02,  4.05it/s]Processing:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:17<00:01,  4.19it/s]Processing:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:17<00:01,  4.50it/s]Processing:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:17<00:01,  4.57it/s]Processing:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:17<00:01,  4.17it/s]Processing:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:18<00:01,  3.96it/s]Processing:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:18<00:00,  3.36it/s]Processing:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:18<00:00,  4.19it/s]Processing:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:18<00:00,  4.33it/s]Processing: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:19<00:00,  3.07it/s]Processing: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:19<00:00,  5.15it/s]
Some weights of RobertaModel were not initialized from the model checkpoint at roberta-large and are newly initialized: ['pooler.dense.bias', 'pooler.dense.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Some weights of RobertaModel were not initialized from the model checkpoint at roberta-large and are newly initialized: ['pooler.dense.bias', 'pooler.dense.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Some weights of RobertaModel were not initialized from the model checkpoint at roberta-large and are newly initialized: ['pooler.dense.bias', 'pooler.dense.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Some weights of RobertaModel were not initialized from the model checkpoint at roberta-large and are newly initialized: ['pooler.dense.bias', 'pooler.dense.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Some weights of RobertaModel were not initialized from the model checkpoint at roberta-large and are newly initialized: ['pooler.dense.bias', 'pooler.dense.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.

Computing overall metrics...

Computing per-category metrics...

============================================================
GENERATION EVALUATION RESULTS
============================================================

=== Overall Metrics (n=100) ===
F1:           0.0719
BLEU:         0.0588
ROUGE-1:      0.1319
ROUGE-2:      0.0590
ROUGE-L:      0.1298
BERTScore-F1: 0.8517

=== By Category ===

Category 1 (n=32):
  F1:           0.0283
  BLEU:         0.0059
  ROUGE-1:      0.0874
  ROUGE-2:      0.0156
  ROUGE-L:      0.0836
  BERTScore-F1: 0.8513

Category 2 (n=37):
  F1:           0.0316
  BLEU:         0.0020
  ROUGE-1:      0.0654
  ROUGE-2:      0.0000
  ROUGE-L:      0.0654
  BERTScore-F1: 0.8245

Category 3 (n=13):
  F1:           0.0192
  BLEU:         0.0147
  ROUGE-1:      0.1275
  ROUGE-2:      0.0256
  ROUGE-L:      0.1275
  BERTScore-F1: 0.8809

Category 4 (n=18):
  F1:           0.2703
  BLEU:         0.1918
  ROUGE-1:      0.3508
  ROUGE-2:      0.2815
  ROUGE-L:      0.3458
  BERTScore-F1: 0.8872

âœ… Results saved to: /home/vinhpq/mem_baseline/amem/test_results_20251211_095326/generation_eval_20251211_095326.json

============================================================
ðŸš€ A-MEM BENCHMARK PIPELINE
============================================================
Dataset: /home/vinhpq/mem_baseline/amem/data/locomo/processed_data/locomo_small_test.json
Memory Dir: /home/vinhpq/mem_baseline/amem/test_memory_20251211_095326
Output Dir: /home/vinhpq/mem_baseline/amem/test_results_20251211_095326
Workers: 1
LLM Model: Qwen/Qwen3-8B
Embedding Model: facebook/contriever
Evolution Threshold: 50
============================================================

ðŸ“ STEP 1: Indexing with A-mem...

============================================================
â–¶ Indexing
============================================================
Command: python3 /home/vinhpq/mem_baseline/amem/amem_process_index.py /home/vinhpq/mem_baseline/amem/data/locomo/processed_data/locomo_small_test.json /home/vinhpq/mem_baseline/amem/test_memory_20251211_095326 --model_name facebook/contriever --llm_model Qwen/Qwen3-8B --api_key dummy --evo_threshold 50 --base_url http://localhost:8001/v1 --disable_thinking
âœ… Indexing completed successfully (1115.60s)

ðŸ” STEP 2: Retrieving memories...

============================================================
â–¶ Retrieval
============================================================
Command: python3 /home/vinhpq/mem_baseline/amem/amem_process_retrieve.py /home/vinhpq/mem_baseline/amem/data/locomo/processed_data/locomo_small_test.json /home/vinhpq/mem_baseline/amem/test_memory_20251211_095326 /home/vinhpq/mem_baseline/amem/test_results_20251211_095326/retrieval_results_20251211_095326.json --top_k 100
âœ… Retrieval completed successfully (22.44s)

ðŸ“Š STEP 3: Evaluating retrieval quality...

============================================================
â–¶ Retrieval Evaluation
============================================================
Command: python3 /home/vinhpq/mem_baseline/retrieval_evaluator.py --input /home/vinhpq/mem_baseline/amem/test_results_20251211_095326/retrieval_results_20251211_095326.json --out /home/vinhpq/mem_baseline/amem/test_results_20251211_095326/retrieval_eval_20251211_095326.json --ks 3,5,10
âœ… Retrieval Evaluation completed successfully (0.50s)

ðŸ¤– STEP 4: Evaluating generation quality...

============================================================
â–¶ Generation Evaluation
============================================================
Command: python3 /home/vinhpq/mem_baseline/generation_evaluator.py /home/vinhpq/mem_baseline/amem/test_results_20251211_095326/retrieval_results_20251211_095326.json --ground-truth /home/vinhpq/mem_baseline/amem/data/locomo/processed_data/locomo_small_test.json --output /home/vinhpq/mem_baseline/amem/test_results_20251211_095326/generation_eval_20251211_095326.json --llm_model Qwen/Qwen3-8B --api_key dummy --base_url http://localhost:8001/v1 --context-k 5 --disable_thinking --limit 100
âœ… Generation Evaluation completed successfully (38.32s)

============================================================
ðŸ“Š A-MEM BENCHMARK RESULTS SUMMARY
============================================================

--- RETRIEVAL EVALUATION ---

@ k=10
  Macro: P=0.0442  R=0.3926  F1=0.0783  nDCG=0.2689
  Micro: P=0.0442  R=0.3480  F1=0.0784  nDCG=0.6340

@ k=3
  Macro: P=0.0795  R=0.2128  F1=0.1128  nDCG=0.2015
  Micro: P=0.0795  R=0.1880  F1=0.1118  nDCG=0.8649

@ k=5
  Macro: P=0.0640  R=0.2864  F1=0.1026  nDCG=0.2347
  Micro: P=0.0640  R=0.2520  F1=0.1020  nDCG=0.7484

  By Category:
    Cat 1: P=0.0312  R=0.1094  F1=0.0479  nDCG=0.1617
    Cat 2: P=0.0486  R=0.4865  F1=0.0885  nDCG=0.3025
    Cat 3: P=0.0455  R=0.2576  F1=0.0760  nDCG=0.2056
    Cat 4: P=0.0457  R=0.4500  F1=0.0829  nDCG=0.2744
    Cat 5: P=0.0468  R=0.4574  F1=0.0848  nDCG=0.3221

--- GENERATION EVALUATION ---

Overall (n=100)
  F1:           0.0719
  BLEU:         0.0588
  ROUGE-1:      0.1319
  ROUGE-2:      0.0590
  ROUGE-L:      0.1298
  BERTScore-F1: 0.8517

  By Category:
    Cat 1 (n=32): F1=0.0283  BLEU=0.0059  BERTScore=0.8513
    Cat 2 (n=37): F1=0.0316  BLEU=0.0020  BERTScore=0.8245
    Cat 3 (n=13): F1=0.0192  BLEU=0.0147  BERTScore=0.8809
    Cat 4 (n=18): F1=0.2703  BLEU=0.1918  BERTScore=0.8872

============================================================
â±ï¸  Total pipeline time: 1176.87s (19.61min)
============================================================

ðŸ“„ Pipeline metadata saved to: /home/vinhpq/mem_baseline/amem/test_results_20251211_095326/pipeline_metadata_20251211_095326.json
ðŸ“„ Retrieval results: /home/vinhpq/mem_baseline/amem/test_results_20251211_095326/retrieval_results_20251211_095326.json
ðŸ“„ Retrieval eval: /home/vinhpq/mem_baseline/amem/test_results_20251211_095326/retrieval_eval_20251211_095326.json
ðŸ“„ Generation eval: /home/vinhpq/mem_baseline/amem/test_results_20251211_095326/generation_eval_20251211_095326.json

âœ… A-mem benchmark pipeline completed successfully!

âœ… Quick test completed!
ðŸ“‚ Results saved to: test_results_20251211_095326/
